<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>WinExe</OutputType>
    <TargetFramework>net8.0-windows</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <AssemblyName>PolicyPPElevationHost</AssemblyName>
    <RootNamespace>PolicyPPElevationHost</RootNamespace>
    <!-- Per-platform build alignment with main WinUI project -->
    <Platforms>x86;x64;ARM64</Platforms>
    <RuntimeIdentifiers>win-x86;win-x64;win-arm64</RuntimeIdentifiers>
    <!-- Assign a single RID matching the current Platform (normalized to lowercase; skips during design-time). -->
    <RuntimeIdentifier Condition="'$(RuntimeIdentifier)'=='' and '$(DesignTimeBuild)'!='true'"
      >win-$([System.String]::Copy('$(Platform)').ToLowerInvariant())</RuntimeIdentifier
    >
    <UseWPF>false</UseWPF>
    <UseWindowsForms>false</UseWindowsForms>
    <LangVersion>latest</LangVersion>
    <EnableDefaultItems>true</EnableDefaultItems>
    <AllowUnsafeBlocks>false</AllowUnsafeBlocks>
    <!-- Do not enforce self-contained during design-time to avoid NETSDK1151 when referenced -->
    <SelfContained Condition="'$(DesignTimeBuild)'!='true'">true</SelfContained>
    <PackageIcon>PolicyPlusPlus_Elevated_icon.png</PackageIcon>
    <ApplicationIcon>Assets\PolicyPlusPlus_Elevated_icon.ico</ApplicationIcon>
  </PropertyGroup>
  <!-- Derive concrete Platform when omitted (mirrors logic in main PolicyPlusPlus project) -->
  <PropertyGroup Condition="'$(Platform)'=='' or '$(Platform)'=='AnyCPU'">
    <_HostArch>$([System.Runtime.InteropServices.RuntimeInformation]::ProcessArchitecture.ToString().ToLowerInvariant())</_HostArch>
    <Platform Condition="'$(_HostArch)'=='x64'">x64</Platform>
    <Platform Condition="'$(_HostArch)'=='arm64'">ARM64</Platform>
    <Platform Condition="'$(_HostArch)'=='x86'">x86</Platform>
    <Platform
      Condition="'$(Platform)'=='' and '$(Platform)'!='x64' and '$(Platform)'!='ARM64' and '$(Platform)'!='x86'"
      >x64</Platform
    >
  </PropertyGroup>
  <ItemGroup>
    <None Remove="Assets\PolicyPlusPlus_Elevated_icon.ico" />
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="Assets\PolicyPlusPlus_Elevated_icon.ico" />
  </ItemGroup>
  <ItemGroup>
    <None Update="Assets\PolicyPlusPlus_Elevated_icon.png">
      <Pack>True</Pack>
      <PackagePath>\</PackagePath>
    </None>
  </ItemGroup>
</Project>
